code: |
  %COM omp_barrier
  %COM mpi_allgather y
  %COM omp_barrier
  %KERNEL RHS_LC y
  %COM omp_barrier
  %LOOP_START k m-1
    %CMD SWAP Yprev Ycur double**
    %KERNEL RHS_LC Yprev[i]
    %COM omp_barrier
    %LOOP_START i s
      %COM mpi_allgather Ycur[i]
    %LOOP_END i
    %COM omp_barrier
  %LOOP_END k
  %CMD SWAP Yprev Ycur double**
  %KERNEL RHS_Approx Yprev[i]
  %KERNEL Update
codegen:
  datastructs: "Y2sn_pFs.h"
